{% extends "base/base.html" %}

{% load staticfiles %}
{% load i18n %}

{% block title %}
{% trans "Algemene informatie over de studie" %}
{% endblock %}

{% block noprogressbar %}{% endblock %}

{% block content %}
<script>
$(function() {
    check_field_required('relation', 'needs_supervisor', 'supervisor');
    depends_on_value('other_applicants', 'True', 'applicants');
    check_field_required('funding', 'needs_details', 'funding_details');

    // Add datepickers for date_start and date_end, set locale to current language
    $.datepicker.setDefaults($.datepicker.regional["{{ LANGUAGE_CODE }}"]);

    $("#id_date_start").datepicker({
        dateFormat: 'dd-mm-yy',
        minDate: 'now',
        onClose: function( selectedDate ) {
            $("#id_date_end").datepicker("option", "minDate", selectedDate);
        }
    });
    $("#id_date_end").datepicker({
        dateFormat: 'dd-mm-yy',
        minDate: 'now',
        onClose: function( selectedDate ) {
            $("#id_date_start").datepicker("option", "maxDate", selectedDate);
        }
    });

    // Adds a running word count to the technical summary
    var summary = $("#id_summary");
    summary.after("<span id='wordcount' />");
    summary[0].addEventListener("input", function() {
        var wordCount = 0; 
        if (this.value.trim()) {
            wordCount = this.value.match(/\S+/g).length;
        }
        $("#wordcount").text(" Aantal woorden: " + wordCount); 
        }, false);
    });
</script>
<form action="" method="post" enctype="multipart/form-data">{% csrf_token %}
    <table>{{ form.as_table }}</table>
    {% include "proposals/form_buttons.html" %}
</form>
{% endblock %}
