

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>proposals.models &mdash; FEtC-H 1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> FEtC-H
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Index</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../maintenance/index.html">Maintenance &amp; administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developing/index.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation/index.html">Server Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/index.html">ethics</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">FEtC-H</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>proposals.models</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for proposals.models</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- encoding: utf-8 -*-</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">unicode_literals</span>

<span class="kn">from</span> <span class="nn">django.conf</span> <span class="k">import</span> <span class="n">settings</span>
<span class="kn">from</span> <span class="nn">django.contrib.auth.models</span> <span class="k">import</span> <span class="n">Group</span>
<span class="kn">from</span> <span class="nn">django.core.validators</span> <span class="k">import</span> <span class="n">MaxValueValidator</span><span class="p">,</span> <span class="n">MinValueValidator</span>
<span class="kn">from</span> <span class="nn">django.db</span> <span class="k">import</span> <span class="n">models</span>
<span class="kn">from</span> <span class="nn">django.utils.encoding</span> <span class="k">import</span> <span class="n">python_2_unicode_compatible</span>
<span class="kn">from</span> <span class="nn">django.utils.translation</span> <span class="k">import</span> <span class="n">ugettext_lazy</span> <span class="k">as</span> <span class="n">_</span>

<span class="kn">from</span> <span class="nn">core.models</span> <span class="k">import</span> <span class="n">YES</span><span class="p">,</span> <span class="n">YES_NO_DOUBT</span>
<span class="kn">from</span> <span class="nn">core.validators</span> <span class="k">import</span> <span class="n">MaxWordsValidator</span><span class="p">,</span> <span class="n">validate_pdf_or_doc</span>
<span class="kn">from</span> <span class="nn">.utils</span> <span class="k">import</span> <span class="n">available_urls</span>

<span class="n">SUMMARY_MAX_WORDS</span> <span class="o">=</span> <span class="mi">200</span>


<div class="viewcode-block" id="Relation"><a class="viewcode-back" href="../../reference/proposals.models.html#proposals.models.Relation">[docs]</a><span class="nd">@python_2_unicode_compatible</span>
<span class="k">class</span> <span class="nc">Relation</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">order</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">PositiveIntegerField</span><span class="p">(</span><span class="n">unique</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">description</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">needs_supervisor</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">check_in_course</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">check_pre_assessment</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">ordering</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;order&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span></div>


<div class="viewcode-block" id="Funding"><a class="viewcode-back" href="../../reference/proposals.models.html#proposals.models.Funding">[docs]</a><span class="nd">@python_2_unicode_compatible</span>
<span class="k">class</span> <span class="nc">Funding</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">order</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">PositiveIntegerField</span><span class="p">(</span><span class="n">unique</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">description</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">needs_details</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">needs_name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">requires_review</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">ordering</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;order&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span></div>


<div class="viewcode-block" id="Institution"><a class="viewcode-back" href="../../reference/proposals.models.html#proposals.models.Institution">[docs]</a><span class="nd">@python_2_unicode_compatible</span>
<span class="k">class</span> <span class="nc">Institution</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">order</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">PositiveIntegerField</span><span class="p">(</span><span class="n">unique</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">description</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">reviewing_chamber</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span>
        <span class="n">Group</span><span class="p">,</span>
        <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">PROTECT</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">ordering</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;order&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span></div>


<div class="viewcode-block" id="Proposal"><a class="viewcode-back" href="../../reference/proposals.models.html#proposals.models.Proposal">[docs]</a><span class="nd">@python_2_unicode_compatible</span>
<span class="k">class</span> <span class="nc">Proposal</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">DRAFT</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">SUBMITTED_TO_SUPERVISOR</span> <span class="o">=</span> <span class="mi">40</span>
    <span class="n">SUBMITTED</span> <span class="o">=</span> <span class="mi">50</span>
    <span class="n">DECISION_MADE</span> <span class="o">=</span> <span class="mi">55</span>
    <span class="n">WMO_DECISION_MADE</span> <span class="o">=</span> <span class="mi">60</span>
    <span class="n">STATUSES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="n">DRAFT</span><span class="p">,</span> <span class="n">_</span><span class="p">(</span><span class="s1">&#39;Concept&#39;</span><span class="p">)),</span>

        <span class="p">(</span><span class="n">SUBMITTED_TO_SUPERVISOR</span><span class="p">,</span>
         <span class="n">_</span><span class="p">(</span><span class="s1">&#39;Opgestuurd ter beoordeling door eindverantwoordelijke&#39;</span><span class="p">)),</span>
        <span class="p">(</span><span class="n">SUBMITTED</span><span class="p">,</span> <span class="n">_</span><span class="p">(</span><span class="s1">&#39;Opgestuurd ter beoordeling door FETC-GW&#39;</span><span class="p">)),</span>

        <span class="p">(</span><span class="n">DECISION_MADE</span><span class="p">,</span> <span class="n">_</span><span class="p">(</span><span class="s1">&#39;Studie is beoordeeld door FETC-GW&#39;</span><span class="p">)),</span>
        <span class="p">(</span><span class="n">WMO_DECISION_MADE</span><span class="p">,</span> <span class="n">_</span><span class="p">(</span><span class="s1">&#39;Studie is beoordeeld door FETC-GW&#39;</span><span class="p">)),</span>
    <span class="p">)</span>

    <span class="n">COURSE</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span>
    <span class="n">EXPLORATION</span> <span class="o">=</span> <span class="s1">&#39;2&#39;</span>
    <span class="n">PRACTICE_REASONS</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="n">COURSE</span><span class="p">,</span> <span class="n">_</span><span class="p">(</span><span class="s1">&#39;in het kader van een cursus&#39;</span><span class="p">)),</span>
        <span class="p">(</span><span class="n">EXPLORATION</span><span class="p">,</span> <span class="n">_</span><span class="p">(</span><span class="s1">&#39;om de portal te exploreren&#39;</span><span class="p">)),</span>
    <span class="p">)</span>

    <span class="c1"># Fields of a proposal</span>
    <span class="n">reference_number</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span>
        <span class="n">max_length</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
        <span class="n">unique</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">reviewing_committee</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span>
        <span class="n">Group</span><span class="p">,</span>
        <span class="n">verbose_name</span><span class="o">=</span><span class="n">_</span><span class="p">(</span>
            <span class="s1">&#39;Door welke comissie dient deze studie te worden beoordeeld?&#39;</span>
        <span class="p">),</span>
        <span class="n">help_text</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">PROTECT</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">institution</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span>
        <span class="n">Institution</span><span class="p">,</span>
        <span class="n">verbose_name</span><span class="o">=</span><span class="n">_</span><span class="p">(</span>
            <span class="s1">&#39;Aan welk onderzoeksinstituut bent u verbonden?&#39;</span>
        <span class="p">),</span>
        <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">PROTECT</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">date_start</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateField</span><span class="p">(</span>
        <span class="n">_</span><span class="p">(</span><span class="s1">&#39;Wat is, indien bekend, de beoogde startdatum van uw studie?&#39;</span><span class="p">),</span>
        <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">title</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span>
        <span class="n">_</span><span class="p">(</span>
            <span class="s1">&#39;Wat is de titel van uw studie? Deze titel zal worden gebruikt in alle formele correspondentie.&#39;</span><span class="p">),</span>
        <span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
        <span class="n">unique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">help_text</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s1">&#39;De titel die u hier opgeeft is zichtbaar voor de </span><span class="se">\</span>
<span class="s1">FETC-GW-leden en, wanneer de studie is goedgekeurd, ook voor alle </span><span class="se">\</span>
<span class="s1">medewerkers die in het archief van deze portal kijken. De titel mag niet </span><span class="se">\</span>
<span class="s1">identiek zijn aan een vorige titel van een studie die u heeft ingediend.&#39;</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="n">summary</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">(</span>
        <span class="n">_</span><span class="p">(</span>
            <span class="s1">&#39;Geef een duidelijke, bondige beschrijving van de onderzoeksvraag of -vragen. Gebruik maximaal 200 woorden.&#39;</span>
        <span class="p">),</span>
        <span class="n">validators</span><span class="o">=</span><span class="p">[</span><span class="n">MaxWordsValidator</span><span class="p">(</span><span class="n">SUMMARY_MAX_WORDS</span><span class="p">)],</span>
        <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">other_applicants</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">(</span>
        <span class="n">_</span><span class="p">(</span>
            <span class="s1">&#39;Zijn er nog andere onderzoekers bij deze studie betrokken die geaffilieerd zijn aan één van de onderzoeksinstituten ICON, OFR, OGK of UiL OTS?&#39;</span>
        <span class="p">),</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">other_stakeholders</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">(</span>
        <span class="n">_</span><span class="p">(</span><span class="s1">&#39;Zijn er nog andere onderzoekers bij deze studie betrokken &#39;</span>
          <span class="s1">&#39;die &lt;strong&gt;niet&lt;/strong&gt; geaffilieerd zijn aan een van de &#39;</span>
          <span class="s1">&#39;onderzoeksinstituten van de Faculteit Geestwetenschappen van de &#39;</span>
          <span class="s1">&#39;UU? &#39;</span><span class="p">),</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">stakeholders</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">(</span>
        <span class="n">_</span><span class="p">(</span><span class="s1">&#39;Andere betrokkenen&#39;</span><span class="p">),</span>
        <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">funding</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ManyToManyField</span><span class="p">(</span>
        <span class="n">Funding</span><span class="p">,</span>
        <span class="n">verbose_name</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s1">&#39;Hoe wordt dit onderzoek gefinancierd?&#39;</span><span class="p">),</span>
        <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">funding_details</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span>
        <span class="n">_</span><span class="p">(</span><span class="s1">&#39;Namelijk&#39;</span><span class="p">),</span>
        <span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
        <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">funding_name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span>
        <span class="n">_</span><span class="p">(</span><span class="s1">&#39;Wat is de naam van het gefinancierde project?&#39;</span><span class="p">),</span>
        <span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
        <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">help_text</span><span class="o">=</span><span class="n">_</span><span class="p">(</span>
            <span class="s1">&#39;De titel die u hier opgeeft zal in de formele toestemmingsbrief gebruikt worden.&#39;</span>
        <span class="p">),</span>
    <span class="p">)</span>

    <span class="n">comments</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">(</span>
        <span class="n">_</span><span class="p">(</span><span class="s1">&#39;Ruimte voor eventuele opmerkingen&#39;</span><span class="p">),</span>
        <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">inform_local_staff</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">NullBooleanField</span><span class="p">(</span>
        <span class="n">_</span><span class="p">(</span><span class="s1">&#39;&lt;p&gt;U hebt aangegeven dat u gebruik wilt gaan maken van één </span><span class="se">\</span>
<span class="s1">van de faciliteiten van het UiL OTS, namelijk de database, Zep software </span><span class="se">\</span>
<span class="s1">en/of het UiL OTS lab. Het lab supportteam van het UiL OTS zou graag op </span><span class="se">\</span>
<span class="s1">de hoogte willen worden gesteld van aankomende studies. </span><span class="se">\</span>
<span class="s1">Daarom vragen wij hier u toestemming om delen van deze aanvraag door te </span><span class="se">\</span>
<span class="s1">sturen naar het lab supportteam.&lt;/p&gt; </span><span class="se">\</span>
<span class="s1">&lt;p&gt;Vindt u het goed dat de volgende delen uit de aanvraag </span><span class="se">\</span>
<span class="s1">worden doorgestuurd:&lt;/p&gt; </span><span class="se">\</span>
<span class="s1">- Uw naam en de namen van de andere betrokkenen &lt;br/&gt; </span><span class="se">\</span>
<span class="s1">- De eindverantwoordelijke van de studie &lt;br/&gt; </span><span class="se">\</span>
<span class="s1">- De titel van de studie &lt;br/&gt; </span><span class="se">\</span>
<span class="s1">- De beoogde startdatum &lt;br/&gt; </span><span class="se">\</span>
<span class="s1">- Van welke faciliteiten u gebruik wilt maken (database, lab, </span><span class="se">\</span>
<span class="s1">Zep software)&#39;</span><span class="p">),</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">in_archive</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">public</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">is_pre_assessment</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">pre_assessment_pdf</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">FileField</span><span class="p">(</span>
        <span class="n">_</span><span class="p">(</span><span class="s1">&#39;Upload hier uw aanvraag (in .pdf of .doc(x)-formaat)&#39;</span><span class="p">),</span>
        <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">validators</span><span class="o">=</span><span class="p">[</span><span class="n">validate_pdf_or_doc</span><span class="p">],</span>
    <span class="p">)</span>

    <span class="n">is_pre_approved</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">NullBooleanField</span><span class="p">(</span>
        <span class="n">_</span><span class="p">(</span>
            <span class="s1">&#39;Heeft u formele toestemming van een ethische toetsingcommissie, &#39;</span>
            <span class="s1">&#39;uitgezonderd deze FETC-GW commissie?&#39;</span><span class="p">),</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">pre_approval_institute</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span>
        <span class="n">_</span><span class="p">(</span><span class="s1">&#39;Welk instituut heeft de studie goedgekeurd?&#39;</span><span class="p">),</span>
        <span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
        <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">pre_approval_pdf</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">FileField</span><span class="p">(</span>
        <span class="n">_</span><span class="p">(</span>
            <span class="s1">&#39;Upload hier uw formele toestemmingsbrief van dit instituut (in .pdf of .doc(x)-formaat)&#39;</span><span class="p">),</span>
        <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">validators</span><span class="o">=</span><span class="p">[</span><span class="n">validate_pdf_or_doc</span><span class="p">],</span>
    <span class="p">)</span>

    <span class="n">in_course</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">(</span>
        <span class="n">_</span><span class="p">(</span><span class="s1">&#39;Ik vul de portal in in het kader van een cursus&#39;</span><span class="p">),</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">is_exploration</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">(</span>
        <span class="n">_</span><span class="p">(</span><span class="s1">&#39;Ik vul de portal in om de portal te exploreren&#39;</span><span class="p">),</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">pdf</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">FileField</span><span class="p">(</span><span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Fields with respect to Studies</span>
    <span class="n">studies_similar</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">NullBooleanField</span><span class="p">(</span>
        <span class="n">_</span><span class="p">(</span><span class="s1">&#39;Doorlopen alle deelnemersgroepen in essentie hetzelfde traject?&#39;</span><span class="p">),</span>
        <span class="n">help_text</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s1">&#39;Daar waar de verschillen klein en qua belasting of </span><span class="se">\</span>
<span class="s1">risico irrelevant zijn is sprake van in essentie hetzelfde traject. Denk </span><span class="se">\</span>
<span class="s1">hierbij aan taakonderzoek waarin de ene groep in taak X de ene helft van </span><span class="se">\</span>
<span class="s1">een set verhaaltjes te lezen krijgt, en de andere groep in taak X de andere </span><span class="se">\</span>
<span class="s1">helft. Of aan interventieonderzoek waarin drie vergelijkbare groepen op </span><span class="se">\</span>
<span class="s1">hetzelfde moment een verschillende interventie-variant krijgen (specificeer </span><span class="se">\</span>
<span class="s1">dan wel bij de beschrijving van de interventie welke varianten precies </span><span class="se">\</span>
<span class="s1">gebruikt worden).&#39;</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="n">studies_number</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">PositiveIntegerField</span><span class="p">(</span>
        <span class="n">_</span><span class="p">(</span><span class="s1">&#39;Hoeveel verschillende trajecten zijn er?&#39;</span><span class="p">),</span>
        <span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">validators</span><span class="o">=</span><span class="p">[</span><span class="n">MinValueValidator</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">MaxValueValidator</span><span class="p">(</span><span class="mi">5</span><span class="p">)],</span>
    <span class="p">)</span>

    <span class="c1"># Status</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">PositiveIntegerField</span><span class="p">(</span>
        <span class="n">choices</span><span class="o">=</span><span class="n">STATUSES</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="n">DRAFT</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">status_review</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">NullBooleanField</span><span class="p">(</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Confirmation</span>
    <span class="n">confirmation_comments</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">(</span>
        <span class="n">_</span><span class="p">(</span><span class="s1">&#39;Ruimte voor eventuele opmerkingen&#39;</span><span class="p">),</span>
        <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Dates for bookkeeping</span>
    <span class="n">date_created</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">auto_now_add</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">date_modified</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">auto_now</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">date_submitted_supervisor</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">date_reviewed_supervisor</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">date_submitted</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">date_reviewed</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">date_confirmed</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateField</span><span class="p">(</span>
        <span class="n">_</span><span class="p">(</span><span class="s1">&#39;Datum bevestigingsbrief verstuurd&#39;</span><span class="p">),</span>
        <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">has_minor_revision</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">(</span>
        <span class="n">_</span><span class="p">(</span><span class="s1">&#39;Is er een revisie geweest na het indienen van deze studie?&#39;</span><span class="p">),</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">minor_revision_description</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">(</span>
        <span class="n">_</span><span class="p">(</span><span class="s1">&#39;Leg uit&#39;</span><span class="p">),</span>
        <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># References to other models</span>
    <span class="n">relation</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span>
        <span class="n">Relation</span><span class="p">,</span>
        <span class="n">verbose_name</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s1">&#39;In welke hoedanigheid bent u betrokken </span><span class="se">\</span>
<span class="s1">bij deze studie?&#39;</span><span class="p">),</span>
        <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">,</span>
        <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">created_by</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span>
        <span class="n">settings</span><span class="o">.</span><span class="n">AUTH_USER_MODEL</span><span class="p">,</span>
        <span class="n">related_name</span><span class="o">=</span><span class="s1">&#39;created_by&#39;</span><span class="p">,</span>
        <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">applicants</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ManyToManyField</span><span class="p">(</span>
        <span class="n">settings</span><span class="o">.</span><span class="n">AUTH_USER_MODEL</span><span class="p">,</span>
        <span class="n">verbose_name</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s1">&#39;Uitvoerende(n) (inclusief uzelf)&#39;</span><span class="p">),</span>
        <span class="n">related_name</span><span class="o">=</span><span class="s1">&#39;applicants&#39;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">supervisor</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span>
        <span class="n">settings</span><span class="o">.</span><span class="n">AUTH_USER_MODEL</span><span class="p">,</span>
        <span class="n">verbose_name</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s1">&#39;Eindverantwoordelijke onderzoeker&#39;</span><span class="p">),</span>
        <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">help_text</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s1">&#39;Aan het einde van de procedure kunt u deze studie ter verificatie naar uw eindverantwoordelijke </span><span class="se">\</span>
<span class="s1">sturen. De eindverantwoordelijke zal de studie vervolgens kunnen aanpassen en indienen bij de FETC-GW.&#39;</span><span class="p">),</span>
        <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Copying an existing Proposal</span>
    <span class="n">parent</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span>
        <span class="s1">&#39;self&#39;</span><span class="p">,</span>
        <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">verbose_name</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s1">&#39;Te kopiëren studie&#39;</span><span class="p">),</span>
        <span class="n">help_text</span><span class="o">=</span><span class="n">_</span><span class="p">(</span>
            <span class="s1">&#39;Dit veld toont enkel studies waar u zelf een medeuitvoerende bent.&#39;</span><span class="p">),</span>
        <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">is_revision</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">(</span>
        <span class="n">_</span><span class="p">(</span>
            <span class="s1">&#39;Is deze studie een revisie van of amendement op een ingediende studie?&#39;</span>
        <span class="p">),</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>

<div class="viewcode-block" id="Proposal.is_practice"><a class="viewcode-back" href="../../reference/proposals.models.html#proposals.models.Proposal.is_practice">[docs]</a>    <span class="k">def</span> <span class="nf">is_practice</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_course</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_exploration</span></div>

<div class="viewcode-block" id="Proposal.accountable_user"><a class="viewcode-back" href="../../reference/proposals.models.html#proposals.models.Proposal.accountable_user">[docs]</a>    <span class="k">def</span> <span class="nf">accountable_user</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">supervisor</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">relation</span><span class="o">.</span><span class="n">needs_supervisor</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">created_by</span></div>

<div class="viewcode-block" id="Proposal.continue_url"><a class="viewcode-back" href="../../reference/proposals.models.html#proposals.models.Proposal.continue_url">[docs]</a>    <span class="k">def</span> <span class="nf">continue_url</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the next URL for this Proposal&quot;&quot;&quot;</span>
        <span class="n">available_urls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">available_urls</span><span class="p">()</span>
        <span class="c1"># For copies, always start at the first available URL</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">available_urls</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">url</span>
        <span class="c1"># Otherwise, loop through the available URLs to find the last non-title with an URL</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">available_url</span> <span class="ow">in</span> <span class="n">available_urls</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">available_url</span><span class="o">.</span><span class="n">url</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">available_url</span><span class="o">.</span><span class="n">is_title</span><span class="p">:</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="n">available_url</span><span class="o">.</span><span class="n">url</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="Proposal.available_urls"><a class="viewcode-back" href="../../reference/proposals.models.html#proposals.models.Proposal.available_urls">[docs]</a>    <span class="k">def</span> <span class="nf">available_urls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the available URLs for this Proposal&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">available_urls</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Proposal.first_study"><a class="viewcode-back" href="../../reference/proposals.models.html#proposals.models.Proposal.first_study">[docs]</a>    <span class="k">def</span> <span class="nf">first_study</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the first Study in this Proposal, or None if there&#39;s none.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">study_set</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s1">&#39;order&#39;</span><span class="p">)[</span>
            <span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">study_set</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="Proposal.last_study"><a class="viewcode-back" href="../../reference/proposals.models.html#proposals.models.Proposal.last_study">[docs]</a>    <span class="k">def</span> <span class="nf">last_study</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the last Study in this Proposal, or None if there&#39;s none.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">study_set</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s1">&#39;-order&#39;</span><span class="p">)[</span>
            <span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">study_set</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="Proposal.current_study"><a class="viewcode-back" href="../../reference/proposals.models.html#proposals.models.Proposal.current_study">[docs]</a>    <span class="k">def</span> <span class="nf">current_study</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the current (incomplete) Study.</span>
<span class="sd">        - If all Studies are completed, the last Study is returned.</span>
<span class="sd">        - If no Studies have yet been created, None is returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">current_study</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">study</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">study_set</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
            <span class="n">current_study</span> <span class="o">=</span> <span class="n">study</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">study</span><span class="o">.</span><span class="n">is_completed</span><span class="p">():</span>
                <span class="k">break</span>
        <span class="k">return</span> <span class="n">current_study</span></div>

<div class="viewcode-block" id="Proposal.current_session"><a class="viewcode-back" href="../../reference/proposals.models.html#proposals.models.Proposal.current_session">[docs]</a>    <span class="k">def</span> <span class="nf">current_session</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the current (incomplete) Session.</span>
<span class="sd">        - If all Sessions are completed, the last Session is returned.</span>
<span class="sd">        - If no Sessions have yet been created, None is returned.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">current_session</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">study</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">study_set</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">session</span> <span class="ow">in</span> <span class="n">study</span><span class="o">.</span><span class="n">session_set</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
                <span class="n">current_session</span> <span class="o">=</span> <span class="n">session</span>
                <span class="k">if</span> <span class="n">session</span><span class="o">.</span><span class="n">tasks_duration</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">break</span>
        <span class="k">return</span> <span class="n">current_session</span></div>

<div class="viewcode-block" id="Proposal.type"><a class="viewcode-back" href="../../reference/proposals.models.html#proposals.models.Proposal.type">[docs]</a>    <span class="k">def</span> <span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the type of a Study: either normal, revision, amendment, preliminary assessment or practice</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s1">&#39;Normaal&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_revision</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">status_review</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s1">&#39;Amendement&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s1">&#39;Revisie&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_pre_assessment</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s1">&#39;Voortoetsing&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_practice</span><span class="p">():</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s1">&#39;Oefening&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_pre_approved</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s1">&#39;Extern getoetst&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="Proposal.supervisor_decision"><a class="viewcode-back" href="../../reference/proposals.models.html#proposals.models.Proposal.supervisor_decision">[docs]</a>    <span class="k">def</span> <span class="nf">supervisor_decision</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the Decision of the supervisor for this Proposal (if any and in current stage)&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">reviews.models</span> <span class="k">import</span> <span class="n">Review</span><span class="p">,</span> <span class="n">Decision</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">supervisor</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="n">Proposal</span><span class="o">.</span><span class="n">SUBMITTED_TO_SUPERVISOR</span><span class="p">:</span>
            <span class="n">decisions</span> <span class="o">=</span> <span class="n">Decision</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">review__proposal</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
                                                <span class="n">review__stage</span><span class="o">=</span><span class="n">Review</span><span class="o">.</span><span class="n">SUPERVISOR</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span>
                <span class="s1">&#39;-pk&#39;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">decisions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_practice</span><span class="p">():</span>
            <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> (</span><span class="si">{}</span><span class="s1">) (Practice)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">created_by</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">created_by</span><span class="p">)</span></div>


<div class="viewcode-block" id="Wmo"><a class="viewcode-back" href="../../reference/proposals.models.html#proposals.models.Wmo">[docs]</a><span class="nd">@python_2_unicode_compatible</span>
<span class="k">class</span> <span class="nc">Wmo</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">NO_WMO</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">WAITING</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">JUDGED</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">WMO_STATUSES</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="n">NO_WMO</span><span class="p">,</span> <span class="n">_</span><span class="p">(</span><span class="s1">&#39;Geen beoordeling door METC noodzakelijk&#39;</span><span class="p">)),</span>
        <span class="p">(</span><span class="n">WAITING</span><span class="p">,</span> <span class="n">_</span><span class="p">(</span><span class="s1">&#39;In afwachting beslissing METC&#39;</span><span class="p">)),</span>
        <span class="p">(</span><span class="n">JUDGED</span><span class="p">,</span> <span class="n">_</span><span class="p">(</span><span class="s1">&#39;Beslissing METC geüpload&#39;</span><span class="p">)),</span>
    <span class="p">)</span>

    <span class="n">metc</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span>
        <span class="n">_</span><span class="p">(</span><span class="s1">&#39;Vindt de dataverzameling plaats binnen het UMC Utrecht of </span><span class="se">\</span>
<span class="s1">andere instelling waar toetsing door een METC verplicht is gesteld?&#39;</span><span class="p">),</span>
        <span class="n">max_length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">choices</span><span class="o">=</span><span class="n">YES_NO_DOUBT</span><span class="p">,</span>
        <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">metc_details</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TextField</span><span class="p">(</span>
        <span class="n">_</span><span class="p">(</span><span class="s1">&#39;Licht toe&#39;</span><span class="p">),</span>
        <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">metc_institution</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span>
        <span class="n">_</span><span class="p">(</span><span class="s1">&#39;Welke instelling?&#39;</span><span class="p">),</span>
        <span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
        <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">is_medical</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span>
        <span class="n">_</span><span class="p">(</span><span class="s1">&#39;Is de onderzoeksvraag medisch-wetenschappelijk van aard </span><span class="se">\</span>
<span class="s1">(zoals gedefinieerd door de WMO)?&#39;</span><span class="p">),</span>
        <span class="n">help_text</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s1">&#39;De definitie van medisch-wetenschappelijk onderzoek is: </span><span class="se">\</span>
<span class="s1">Medisch-wetenschappelijk onderzoek is onderzoek dat als doel heeft het </span><span class="se">\</span>
<span class="s1">beantwoorden van een vraag op het gebied van ziekte en gezondheid </span><span class="se">\</span>
<span class="s1">(etiologie, pathogenese, verschijnselen/symptomen, diagnose, preventie, </span><span class="se">\</span>
<span class="s1">uitkomst of behandeling van ziekte), door het op systematische wijze </span><span class="se">\</span>
<span class="s1">vergaren en bestuderen van gegevens. Het onderzoek beoogt bij te dragen </span><span class="se">\</span>
<span class="s1">aan medische kennis die ook geldend is voor populaties buiten de directe </span><span class="se">\</span>
<span class="s1">onderzoekspopulatie. (CCMO-notitie, Definitie medisch-wetenschappelijk </span><span class="se">\</span>
<span class="s1">onderzoek, 2005, ccmo.nl)&#39;</span><span class="p">),</span>
        <span class="n">max_length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">choices</span><span class="o">=</span><span class="n">YES_NO_DOUBT</span><span class="p">,</span>
        <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">is_behavioristic</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span>
        <span class="n">_</span><span class="p">(</span><span class="s1">&#39;Worden de deelnemers aan een handeling onderworpen of worden </span><span class="se">\</span>
<span class="s1">hen gedragsregels opgelegd (zoals gedefinieerd door de WMO)?&#39;</span><span class="p">),</span>
        <span class="n">help_text</span><span class="o">=</span><span class="n">_</span><span class="p">(</span><span class="s1">&#39;Een handeling of opgelegde gedragsregel varieert </span><span class="se">\</span>
<span class="s1">tussen het afnemen van weefsel bij een deelnemer tot de deelnemer een </span><span class="se">\</span>
<span class="s1">knop/toets in laten drukken. Bij observatieonderzoek waarbij er niets </span><span class="se">\</span>
<span class="s1">van de deelnemers gevraagd wordt, deze dus uitsluitend geobserveerd </span><span class="se">\</span>
<span class="s1">worden in hun leven zoals het ook had plaatsgevonden zonder de observatie, </span><span class="se">\</span>
<span class="s1">slechts dan kan &quot;nee&quot; ingevuld worden.&#39;</span><span class="p">),</span>
        <span class="n">max_length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">choices</span><span class="o">=</span><span class="n">YES_NO_DOUBT</span><span class="p">,</span>
        <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">metc_application</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">(</span>
        <span class="n">_</span><span class="p">(</span><span class="s1">&#39;Uw studie moet beoordeeld worden door de METC, maar dient nog </span><span class="se">\</span>
<span class="s1">wel bij de FETC-GW te worden geregistreerd. Is deze studie al aangemeld </span><span class="se">\</span>
<span class="s1">bij een METC?&#39;</span><span class="p">),</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">metc_decision</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">(</span>
        <span class="n">_</span><span class="p">(</span><span class="s1">&#39;Is de METC al tot een beslissing gekomen?&#39;</span><span class="p">),</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">metc_decision_pdf</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">FileField</span><span class="p">(</span>
        <span class="n">_</span><span class="p">(</span><span class="s1">&#39;Upload hier de beslissing van het METC </span><span class="se">\</span>
<span class="s1">(in .pdf of .doc(x)-formaat)&#39;</span><span class="p">),</span>
        <span class="n">blank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">validators</span><span class="o">=</span><span class="p">[</span><span class="n">validate_pdf_or_doc</span><span class="p">],</span>
    <span class="p">)</span>

    <span class="c1"># Status</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">PositiveIntegerField</span><span class="p">(</span>
        <span class="n">choices</span><span class="o">=</span><span class="n">WMO_STATUSES</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="n">NO_WMO</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">enforced_by_commission</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># References</span>
    <span class="n">proposal</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">OneToOneField</span><span class="p">(</span>
        <span class="n">Proposal</span><span class="p">,</span>
        <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">,</span>
    <span class="p">)</span>

<div class="viewcode-block" id="Wmo.save"><a class="viewcode-back" href="../../reference/proposals.models.html#proposals.models.Wmo.save">[docs]</a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the correct status on save of a WMO&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_status</span><span class="p">()</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Wmo</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Wmo.update_status"><a class="viewcode-back" href="../../reference/proposals.models.html#proposals.models.Wmo.update_status">[docs]</a>    <span class="k">def</span> <span class="nf">update_status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">metc</span> <span class="o">==</span> <span class="n">YES</span> <span class="ow">or</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">is_medical</span> <span class="o">==</span> <span class="n">YES</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_behavioristic</span> <span class="o">==</span> <span class="n">YES</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">enforced_by_commission</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">metc_decision</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">metc_decision_pdf</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">JUDGED</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">WAITING</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NO_WMO</span></div>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_</span><span class="p">(</span><span class="s1">&#39;WMO </span><span class="si">{title}</span><span class="s1">, status </span><span class="si">{status}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proposal</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="p">)</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Martijn van der Klis &amp; Ty Mees

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>